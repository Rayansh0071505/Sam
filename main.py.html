
<!-- saved from url=(0068)file:///C:/Users/Rayan/PycharmProjects/sam/exportToHTML/main.py.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>main.py</title>

<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table cellspacing="0" cellpadding="5" cols="1" width="100%" bgcolor="#606060">
<tbody><tr><td><center>
<font face="Arial, Helvetica" color="#000000">
main.py</font>
</center></td></tr></tbody></table>
<pre><span class="s0">import </span><span class="s1">speech_recognition </span><span class="s0">as </span><span class="s1">sr</span>
<span class="s0">import </span><span class="s1">webbrowser</span>
<span class="s0">import </span><span class="s1">time</span>
<span class="s0">import </span><span class="s1">playsound</span>
<span class="s0">import </span><span class="s1">os</span>
<span class="s0">from </span><span class="s1">gtts </span><span class="s0">import </span><span class="s1">gTTS</span>
<span class="s0">import </span><span class="s1">random</span>
<span class="s0">from </span><span class="s1">time </span><span class="s0">import </span><span class="s1">ctime</span>


<span class="s1">r=sr.Recognizer()</span>
<span class="s0">def </span><span class="s1">main():</span>
    <span class="s0">def </span><span class="s1">record_audio(ask=</span><span class="s0">False</span><span class="s1">):</span>
        <span class="s0">with </span><span class="s1">sr.Microphone() </span><span class="s0">as </span><span class="s1">source:</span>
            <span class="s0">if </span><span class="s1">ask:</span>
                <span class="s1">sam_speak(ask)</span>

            <span class="s1">audio = r.listen(source)</span>
            <span class="s0">try</span><span class="s1">:</span>
                <span class="s1">voice_data = r.recognize_google(audio)</span>
            <span class="s0">except </span><span class="s1">sr.UnknownValueError:</span>
                <span class="s1">sam_speak(</span><span class="s2">'Sorry, I did not get that'</span><span class="s1">)</span>
            <span class="s0">except </span><span class="s1">sr.RequestError:</span>
                <span class="s1">sam_speak(</span><span class="s2">'Sorry, my speech service is down'</span><span class="s1">)</span>
            <span class="s0">return </span><span class="s1">voice_data</span>

    <span class="s0">def </span><span class="s1">sam_speak(audio_string):</span>
        <span class="s1">tts = gTTS(text=audio_string</span><span class="s0">, </span><span class="s1">lang=</span><span class="s2">'en'</span><span class="s1">)</span>
        <span class="s1">r = random.randint(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">10000000</span><span class="s1">)</span>
        <span class="s1">audio_file = </span><span class="s2">'audio-' </span><span class="s1">+ str(r) + </span><span class="s2">'.mp3'</span>
        <span class="s1">tts.save(audio_file)</span>
        <span class="s1">playsound.playsound(audio_file)</span>
        <span class="s1">print(audio_string)</span>
        <span class="s1">os.remove(audio_file)</span>

    <span class="s0">def </span><span class="s1">respond(voice_data):</span>
        <span class="s0">if </span><span class="s2">'hello' </span><span class="s0">in </span><span class="s1">voice_data:</span>

            <span class="s1">sam_speak(</span><span class="s2">"Hello,Welcome to VakeelSearch, My name is Sam , i am doing parttime job here,How are you dear,"</span><span class="s1">)</span>
            <span class="s1">sam_speak(</span><span class="s2">"How can i help you"</span><span class="s1">)</span>
        <span class="s0">if </span><span class="s2">'what is your name' </span><span class="s0">in </span><span class="s1">voice_data:</span>
            <span class="s1">sam_speak(</span><span class="s2">"My name is sam but people call me Mrs.Sam"</span><span class="s1">)</span>
        <span class="s0">if </span><span class="s2">'by the way what time is it' </span><span class="s0">in </span><span class="s1">voice_data:</span>
            <span class="s1">sam_speak(ctime())</span>
        <span class="s0">if </span><span class="s2">'search' </span><span class="s0">in </span><span class="s1">voice_data:</span>
            <span class="s1">search = record_audio(</span><span class="s2">'What do you want to search for ?'</span><span class="s1">)</span>

            <span class="s1">url = </span><span class="s2">'https://google.com/search?q=' </span><span class="s1">+ search</span>
            <span class="s1">webbrowser.get().open(url)</span>
            <span class="s1">sam_speak(</span><span class="s2">'Here is what i found for ' </span><span class="s1">+ search)</span>

        <span class="s0">if </span><span class="s2">'disable' </span><span class="s0">in </span><span class="s1">voice_data:</span>
            <span class="s1">disable=record_audio(</span><span class="s2">'ok give me one second let me search this request for you'</span><span class="s1">)</span>
            <span class="s1">url = </span><span class="s2">'https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5419007/'</span>
            <span class="s1">webbrowser.get().open(url)</span>
            <span class="s1">sam_speak(</span><span class="s2">'Here is what i found for ' </span><span class="s1">+ disable)</span>

        <span class="s0">if </span><span class="s2">'able' </span><span class="s0">in </span><span class="s1">voice_data:</span>
            <span class="s1">able=record_audio(</span><span class="s2">"I feel really bad , how can i help"</span><span class="s1">)</span>
            <span class="s1">url=</span><span class="s2">'https://indianexpress.com/article/explained/everyday-explainers/explained-posh-law-against-sexual-harassment-in-india-7825733/'</span>
            <span class="s1">webbrowser.get().open(url)</span>
            <span class="s1">sam_speak(</span><span class="s2">'see can this help you ' </span><span class="s1">+ able)</span>
        <span class="s0">if </span><span class="s2">'use' </span><span class="s0">in </span><span class="s1">voice_data:</span>
            <span class="s1">use=record_audio(</span><span class="s2">"What you want to know?"</span><span class="s1">)</span>
            <span class="s1">url=</span><span class="s2">'https://indianexpress.com/article/explained/legal-age-marriage-for-women-india-law-7676748/#:~:text=Under%20the%20Child%20Marriage%20Prevention,child%20marriage%20can%20be%20punished.' </span><span class="s1">+ use</span>
            <span class="s1">webbrowser.get().open(url)</span>
            <span class="s1">sam_speak(</span><span class="s2">'No dont you even dare to try ,read this article' </span><span class="s1">+ use)</span>
        <span class="s0">if </span><span class="s2">'ok' </span><span class="s0">in </span><span class="s1">voice_data:</span>


            <span class="s1">sam_speak(</span><span class="s2">"i am chill you take care about yourself"</span><span class="s1">)</span>

        <span class="s0">if </span><span class="s2">'y' </span><span class="s0">in </span><span class="s1">voice_data:</span>
            <span class="s1">y=record_audio(</span><span class="s2">"ok user how can i help"</span><span class="s1">)</span>
            <span class="s1">url=</span><span class="s2">'https://vakilsearch.com/iso-certification'</span>
            <span class="s1">webbrowser.get().open(url)</span>
            <span class="s1">sam_speak(</span><span class="s2">'see can this help you '</span><span class="s1">)</span>

        <span class="s0">if </span><span class="s2">'start' </span><span class="s0">in </span><span class="s1">voice_data:</span>
            <span class="s1">sam_speak(</span><span class="s2">"Hello judges I am sam, i am personal assistant who direct user request, i am only model version so "</span><span class="s1">)</span>
            <span class="s1">sam_speak(</span><span class="s2">"i still lacking many features, sorry for that"</span><span class="s1">)</span>

        <span class="s0">if </span><span class="s2">'register' </span><span class="s0">in </span><span class="s1">voice_data:</span>
            <span class="s1">register=record_audio(</span><span class="s2">'ok what do you want to register'</span><span class="s1">)</span>
            <span class="s1">url = </span><span class="s2">'https://vakilsearch.com/form-page/online-pf-registration'</span>
            <span class="s1">webbrowser.get().open(url)</span>
            <span class="s1">sam_speak(</span><span class="s2">'Here is what i found for '</span><span class="s1">)</span>

        <span class="s0">if </span><span class="s2">'tax' </span><span class="s0">in </span><span class="s1">voice_data:</span>
            <span class="s1">tax=record_audio(</span><span class="s2">"What do you want to know"</span><span class="s1">)</span>
            <span class="s1">url = </span><span class="s2">'https://vakilsearch.com/proposal-for-rbi-compounding-application'</span>
            <span class="s1">webbrowser.get().open(url)</span>
            <span class="s1">sam_speak(</span><span class="s2">"see is this ok"</span><span class="s1">)</span>


        <span class="s0">if </span><span class="s2">'exit' </span><span class="s0">in </span><span class="s1">voice_data:</span>
            <span class="s1">sam_speak(</span><span class="s2">"Thank you judges, hope you like it , give me some more time i will become more intelligent"</span><span class="s1">)</span>
            <span class="s1">exit()</span>


    <span class="s1">time.sleep(</span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">sam_speak(</span><span class="s2">"How can i help you"</span><span class="s1">)</span>
    <span class="s0">while </span><span class="s3">1</span><span class="s1">:</span>
            <span class="s1">voice_data= record_audio()</span>
            <span class="s1">respond(voice_data)</span>

<span class="s4"># try to speak with local language</span>
<span class="s0">if </span><span class="s1">__name__ == </span><span class="s2">"__main__"</span><span class="s1">:</span>
    <span class="s1">main()</span>

</pre>

</body></html>